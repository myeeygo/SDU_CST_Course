# Project02-图像水印嵌入与提取 说明文档

## 概述

本项目实现了基于 DCT 技术的图像水印提取与嵌入，并通过裁剪、旋转、压缩等进行鲁棒性测试。

## 技术原理
图像水印技术是一种在数字图像中嵌入特定信息（水印）的技术，其核心目标是在保证图像不可见性（水印不影响原图视觉效果）的前提下，实现水印的鲁棒性（抵抗压缩、噪声、裁剪等攻击）和安全性（不易被篡改或移除）。离散余弦变换（DCT）是图像水印中最常用的变换域技术之一，因其与 JPEG 等主流图像压缩标准兼容，且能在频率域平衡不可见性与鲁棒性，被广泛应用。

离散余弦变换（DCT）：将图像从空间域（像素值）转换到频率域，通过余弦函数分解图像信号。变换后得到的DCT 系数按频率高低分布：低频系数集中图像主要能量（对应平滑区域），高频系数对应细节（如边缘、纹理），能量较低。

人类视觉系统（HVS）对低频分量的变化更敏感（影响不可见性），对高频分量的微小变化不敏感，但高频分量易受压缩、噪声等攻击破坏。因此，DCT 域可通过选择中频系数嵌入水印，兼顾不可见性（修改幅度小）和鲁棒性（中频系数抗攻击能力适中）。

## 代码文件框架
### watermarking.py文件中：

首先对自定义水印进行大小调整并二值化。之后，读取要加水印的图像，转为 YCrCb 色彩空间，分离亮度通道（Y 通道），对 Y 通道进行离散余弦变换。在 DCT 系数的中频区域（以图像中心为圆心的圆形区域） 进行水印嵌入。之后，对修改后的 DCT 系数进行逆变换，合并通道并保存水印图像。

提取水印时，首先读取水印图像，转为 YCrCb 色彩空间，分离 Y 通道。对 Y 通道进行 DCT 变换，提取中频系数。提取出水印后，和原始水印进行相似度评估。

### robustness_tests.py文件中：

对提取水印的鲁棒性进行测试，包括裁剪、旋转、压缩等。

首先，读取待提取水印的图像，对图像进行不同的处理，如裁剪、旋转、压缩等。分别提取处理后的图像水印，并计算相似度，评估鲁棒性。

### main.py文件中：
首先，配置环境并初始化水印系统，指定自定义水印路径和强度参数；接着读取原始图像，完成水印嵌入并保存带水印的图像，同时提取原始水印并可视化存储。

随后，从刚生成的带水印图像中提取水印，通过 NCC 系数评估提取效果并输出结果。为测试水印的鲁棒性，代码初始化了鲁棒性测试器，定义了旋转、缩放、裁剪、亮度调整、噪声添加、JPEG 压缩等多种攻击方式，并依次对带水印图像执行这些攻击。

对于每种攻击，代码会保存攻击后的图像及从中提取的水印，计算并记录对应的 NCC 值，用于衡量水印在攻击后的保留程度。最后，通过柱状图可视化各类攻击下的 NCC 结果，直观展示水印的抗攻击能力；同时生成原始图像、带水印图像与提取水印的对比图，全面呈现水印系统的性能。

### 实验结果与分析
实验结果表明，基于 DCT 域的图像水印嵌入方法在抵抗多种攻击的同时，具有较高的不可见性和鲁棒性。同时，通过 NCC 系数评估，提取的水印与原始水印的相似度随着攻击强度的增加而下降，验证了水印的鲁棒性。

## 总结
本项目基于 DCT 技术实现了图像水印的嵌入与提取，并通过鲁棒性测试验证了其有效性。